<root BTCPP_format="4" main_tree_to_execute="MainTree">
  <BehaviorTree ID="MainTree">
    <PipelineSequence name="NavigateWithReplanning">
      <ControllerSelector selected_controller="{selected_controller}" default_controller="FollowPath" topic_name="controller_selector"/>
      <PlannerSelector selected_planner="{selected_planner}" default_planner="GridBased" topic_name="planner_selector"/>
      <RateController hz="2.0">
        <RetryUntilSuccessful num_attempts="3" name="PlanningRetry">
          <Sequence>
            <GoalUpdater input_goal="{goal}" output_goal="{updated_goal}">
              <ComputePathToPose goal="{updated_goal}" path="{path}" planner_id="{selected_planner}"/>
            </GoalUpdater>
           <TruncatePath distance="0.3" input_path="{path}" output_path="{truncated_path}"/>
          </Sequence>
        </RetryUntilSuccessful>
      </RateController>
      <RetryUntilSuccessful num_attempts="5" name="ControllerRetry">
        <KeepRunningUntilFailure>
          <FollowPath path="{truncated_path}" controller_id="{selected_controller}"/>
        </KeepRunningUntilFailure>
      </RetryUntilSuccessful>
    </PipelineSequence>
  </BehaviorTree>
</root>