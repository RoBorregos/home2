<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Roborregos @Home documentation: Vision</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Roborregos @Home documentation<span id="projectnumber">&#160;1.0.0</span>
   </div>
   <div id="projectbrief">Class documentation for the Roborregos @Home project</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_docs_Run_Areas_vision.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Vision </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>To run or test the modules it is necessary to have Ubuntu 22.04. Alternatively, you can use the docker setup provided in this repository.</p>
<h1><a class="anchor" id="autotoc_md74"></a>
Docker setup</h1>
<p>To make a container and open a shell for developing or testing the vision package, use the script <code>docker/vision/run.sh</code>. This can be accessed from the general script <code>./run.sh</code> in the root directory by passing the argument vision. This will first build the base image according to your system (cpu, cuda or jetson) as well as the image for the vision module and then run the container.</p>
<p>In root directory (home2), run: </p><div class="fragment"><div class="line">./run.sh vision</div>
</div><!-- fragment --><p>If the script is not executable, run: </p><div class="fragment"><div class="line">chmod +x run.sh</div>
</div><!-- fragment --><p>If the camera is not available run the following command before running the <code>/run.sh vision</code> command: </p><div class="fragment"><div class="line">sudo chmod 666 /dev/video0</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md75"></a>
Running the vision module</h1>
<p>Once in the docker workspace or using ROS2 in the home2 directory, run the following commands:</p>
<h3><a class="anchor" id="autotoc_md76"></a>
Build</h3>
<p>Run the following command for each package or packages that should be built:</p>
<div class="fragment"><div class="line">colcon build --packages-up-to vision_general </div>
</div><!-- fragment --><p>Then source:</p>
<div class="fragment"><div class="line">source install/setup.bash</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md77"></a>
Run</h3>
<p>Run a node using the following command:</p>
<div class="fragment"><div class="line">ros2 run &lt;package&gt; &lt;node_name&gt;</div>
<div class="line">ros2 run vision_general zed_simulator.py</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md78"></a>
Structure</h1>
<p>Vision is divided into the following packages:</p><ul>
<li><a class="el" href="namespacevision__general.html">vision_general</a></li>
<li>moondream_run</li>
<li>object_detector_2d</li>
<li>object_detection_handler</li>
</ul>
<h1><a class="anchor" id="autotoc_md79"></a>
Camera</h1>
<p>To use de zed camera run the following command in orin:</p>
<div class="fragment"><div class="line">ros2 launch zed_wrapper zed_camera.launch.py camera_model:=zed2 publish_tf:=false</div>
</div><!-- fragment --><p>If no zed camera is available you can run the zed simulator with an alternative camera with the following command:</p>
<div class="fragment"><div class="line">ros2 run vision_general zed_simulator.py --ros-args -p video_id:=1</div>
</div><!-- fragment --><p>The video_id parameter is the id of the camera. To test camera ids and find the id or simply test the camera, run the following command:</p>
<div class="fragment"><div class="line">python3 vision/packages/vision_general/Utils/camera_test.py &lt;video_id&gt;</div>
<div class="line">python3 vision/packages/vision_general/Utils/camera_test.py 2</div>
</div><!-- fragment --><p>Test different ids by passing the argument. Default is 0. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
