<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Roborregos @Home documentation: Decorators</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Roborregos @Home documentation<span id="projectnumber">&#160;1.0.0</span>
   </div>
   <div id="projectbrief">Class documentation for the Roborregos @Home project</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_docs_task_manager_decorators.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Decorators </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md110"></a>
Mockable</h1>
<p>This decorator is used to return a default value for a function. This is important when mocking individual functions or a complete area. In task managers, when an area is set to mock, all functions in that area will be mocked even if their decorator mock value is false.</p>
<h2><a class="anchor" id="autotoc_md111"></a>
Parameters</h2>
<p>Arguments:</p><ul>
<li><code>return_value</code>:</li>
</ul>
<p>The value to return when the function is called.</p>
<p>Default is void.</p>
<ul>
<li><code>delay</code>:</li>
</ul>
<p>The time to wait before returning the value.</p>
<p>Default is 0 seconds.</p>
<ul>
<li><code>mock</code>:</li>
</ul>
<p>If true, the function will be mocked and the default value will be returned.</p>
<p>Default is false.</p>
<h2><a class="anchor" id="autotoc_md112"></a>
Implementation</h2>
<div class="fragment"><div class="line"><span class="preprocessor">@mockable(return_value=&lt;default_value&gt;, delay=(int)</span>&lt;delay-seconds&gt;, mock=(bool)&lt;mock&gt;)</div>
</div><!-- fragment --><p> Example </p><div class="fragment"><div class="line"><span class="preprocessor">@mockable(return_value=&quot;Success&quot;, delay=2, mock=True)</span> </div>
<div class="line"><span class="keyword">def </span>do_something(self):</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;&lt;docstring&gt;&quot;&quot;&quot;</span></div>
<div class="line">    <span class="comment"># function implementation</span></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md113"></a>
Service Check</h1>
<p>This decorator will internally wait for a service to check if it is available and return a default value if it is not. When not implemented, if a task manager is running and a service is not available, the task will get stuck without any indication. Therefore, this decorator is important to ensure that the task manager does not get stuck and can return an error value.</p>
<h2><a class="anchor" id="autotoc_md114"></a>
Parameters</h2>
<p>Arguments:</p><ul>
<li><code>client</code>:</li>
</ul>
<p>The name of the client to check. (It can be a service or a action client)</p>
<ul>
<li><code>default_value</code>:</li>
</ul>
<p>The value to return when the service is not available. Default is None.</p>
<ul>
<li><code>timeout</code>:</li>
</ul>
<p>The time set to wait for service. Default is 3 seconds.</p>
<h2><a class="anchor" id="autotoc_md115"></a>
Implementation</h2>
<div class="fragment"><div class="line"><span class="preprocessor">@service_check(client=&quot;client_name&quot;, default_value=&lt;default_value&gt;, timeout=(int)</span>&lt;timeout-seconds&gt;)</div>
</div><!-- fragment --><p>Example </p><div class="fragment"><div class="line"><span class="preprocessor">@service_check(client=&quot;client_name&quot;, default_value=&quot;Error&quot;, timeout=2)</span></div>
<div class="line"><span class="keyword">def </span>do_something(self):</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;&lt;docstring&gt;&quot;&quot;&quot;</span></div>
<div class="line">    <span class="comment"># function implementation</span></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md116"></a>
Example</h1>
<p>*If using both, the mockable should come first:</p>
<div class="fragment"><div class="line"><span class="preprocessor">@mockable(return_value=Status.EXECUTION_SUCCESS, delay=2)</span></div>
<div class="line">@service_check(<span class="stringliteral">&quot;track_person_client&quot;</span>, Status.EXECUTION_ERROR, TIMEOUT)</div>
<div class="line"><span class="keyword">def </span>track_person(self, track: bool = <span class="keyword">True</span>):</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;Track the person in the image&quot;&quot;&quot;</span></div>
<div class="line">    Logger.info(self.node, <span class="stringliteral">&quot;Tracking person&quot;</span>)</div>
<div class="line">    request = SetBool.Request()</div>
<div class="line">    request.data = track</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">try</span>:</div>
<div class="line">        future = self.track_person_client.call_async(request)</div>
<div class="line">        rclpy.spin_until_future_complete(self.node, future, timeout_sec=TIMEOUT)</div>
<div class="line">        result = future.result()</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> <span class="keywordflow">not</span> result.success:</div>
<div class="line">            Logger.warn(self.node, <span class="stringliteral">&quot;No person found&quot;</span>)</div>
<div class="line">            <span class="keywordflow">return</span> Status.TARGET_NOT_FOUND</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line">        Logger.error(self.node, f<span class="stringliteral">&quot;Error tracking person: {e}&quot;</span>)</div>
<div class="line">        <span class="keywordflow">return</span> Status.EXECUTION_ERROR</div>
<div class="line"> </div>
<div class="line">    Logger.success(self.node, <span class="stringliteral">&quot;Person tracking success&quot;</span>)</div>
<div class="line">    <span class="keywordflow">return</span> Status.EXECUTION_SUCCESS</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
