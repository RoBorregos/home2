<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Roborregos @Home documentation: xarm_ros2说明</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Roborregos @Home documentation<span id="projectnumber">&#160;1.0.0</span>
   </div>
   <div id="projectbrief">Class documentation for the Roborregos @Home project</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('md__2home_2deivideich_2roborregos_2home__ws_2src_2home2_2manipulation_2packages_2xarm__ros2_2ReadMe__cn.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">xarm_ros2说明 </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md142"></a></p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md143"></a>
1. 简介</h1>
<p>&ensp;&ensp;&ensp;&ensp;此代码库包含xArm模型文件以及相关的控制、规划等示例开发包。开发及测试使用的环境如下</p><ul>
<li>Ubuntu 20.04 + ROS Foxy</li>
<li>Ubuntu 20.04 + ROS Galactic</li>
<li>Ubuntu 22.04 + ROS Humble</li>
<li>Ubuntu 24.04 + ROS Jazzy</li>
<li>Ubuntu 22.04 + ROS Rolling</li>
</ul>
<p>&ensp;&ensp;&ensp;&ensp;请根据不同ros2版本切换到对应的代码分支（没有对应的代码分支表示未在该版本测试过）</p><ul>
<li>Foxy: <a href="https://github.com/xArm-Developer/xarm_ros2/tree/foxy">foxy</a></li>
<li>Galactic: <a href="https://github.com/xArm-Developer/xarm_ros2/tree/galactic">galactic</a></li>
<li>Humble: <a href="https://github.com/xArm-Developer/xarm_ros2/tree/humble">humble</a></li>
<li>Jazzy: <a href="https://github.com/xArm-Developer/xarm_ros2/tree/jazzy">jazzy</a></li>
<li>Rolling: <a href="https://github.com/xArm-Developer/xarm_ros2/tree/rolling">rolling</a></li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md144"></a>
2. 更新记录</h1>
<ul>
<li>新增xarm_gazebo以支持gazebo，并和moveit关联</li>
<li>支持加载其它模型到机械臂末端</li>
<li>新增xarm_moveit_servo支持xbox手柄/SpaceMouse/键盘控制</li>
<li>(2022-09-07) 变更service(<b>set_tgpio_modbus_timeout</b>/__getset_tgpio_modbus_data__)的参数类型，增加参数支持透传</li>
<li>(2022-09-07) 变更Topic名字(xarm_states改为robot_states)</li>
<li>(2022-09-07) 更新子模块xarm-sdk到1.11.0版本</li>
<li>(2022-09-09) [Beta]支持Ros Humble版本</li>
<li>(2022-10-10) xarm_api新增一些服务</li>
<li>(2022-12-15) 新增参数<span class="tt">add_realsense_d435i</span>以加载RealSense D435i摄像头模型，并支持gazebo仿真</li>
<li>(2023-03-29) 新增launch启动参数<span class="tt">model1300</span>(默认为false), 更换xarm机械臂末端模型为1300系列的</li>
<li>(2023-04-20) 更新URDF文件，适配ROS1和ROS2，并根据SN从配置文件加载连杆的惯性参数</li>
<li>(2023-04-20) 新增launch启动参数<span class="tt">add_d435i_links</span>(默认为false), 支持在加载RealSense D435i模型的情况下增加D435i的各摄像头之间的连杆关系，在<span class="tt">add_realsense_d435i</span>为true时才有用</li>
<li>(2023-04-20) Lite6支持<span class="tt">add_realsense_d435i</span>和<span class="tt">add_d435i_links</span>参数</li>
<li>(2023-04-20) 新增launch启动参数<span class="tt">robot_sn</span>支持加载对应的关节连杆的惯性参数，并自动覆盖model1300参数</li>
<li>(2023-04-20) 新增launch启动参数 <span class="tt">attach_to</span>/<span class="tt">attach_xyz</span>/<span class="tt">attach_rpy</span>，支持把机械臂模型依附在其它模型之上</li>
<li>(2023-06-07) 新增对UFACTORY850机械臂的支持</li>
<li>(2023-10-12) 新增关节kinematics参数文件的生成与使用</li>
<li>(2024-01-17) 新增对xarm7_mirror型号机械臂的支持</li>
<li>(2024-02-27) 新增对Bio Gripper的支持(参数<span class="tt">add_bio_gripper</span>, Lite6不支持)</li>
<li>(2024-04-12) 新增 <b><a class="el" href="namespaceuf__ros__lib.html">uf_ros_lib</a></b> 封装某些功能以供调用(包括 <b>MoveItConfigsBuilder</b>)，参见<a class="el" href="Readme_8md.html">文档</a></li>
<li>(2024-10-11) 增加<a class="el" href="readme_8md.html">mbot_demo</a>演示如何建立xarm机械臂在底盘之上</li>
<li>(2024-11-05) 支持Ros Jazzy版本</li>
<li>(2024-12-02) 新增xarm_api封装的sdk服务的详细使用说明 <br  />
</li>
<li>(2025-05-28) 新增xarm_vision</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md145"></a>
3. 准备工作</h1>
<ul>
<li>### 3.1 安装 <a href="https://docs.ros.org/">ROS2</a><ul>
<li><a href="https://docs.ros.org/en/ros2_documentation/foxy/Installation.html">Foxy</a></li>
<li><a href="https://docs.ros.org/en/ros2_documentation/galactic/Installation.html">Galactic</a></li>
<li><a href="https://docs.ros.org/en/ros2_documentation/humble/Installation.html">Humble</a></li>
<li><a href="https://docs.ros.org/en/ros2_documentation/jazzy/Installation.html">Jazzy</a></li>
</ul>
</li>
<li>### 3.2 安装 <a href="https://moveit.ros.org/install-moveit2/binary/">Moveit2</a></li>
<li>### 3.3 安装 <a href="https://classic.gazebosim.org/tutorials?tut=install_ubuntu">Gazebo</a> <br  />
</li>
<li>### 3.4 安装 <a href="http://gazebosim.org/tutorials?tut=ros2_installing&amp;cat=connect_ros">gazebo_ros_pkgs</a> <br  />
</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md146"></a>
4. 使用说明</h1>
<ul>
<li>### 4.1 创建工作区 <div class="fragment"><div class="line"># 如果已经有自己工作区，请跳过这一步骤</div>
<div class="line">$ cd ~</div>
<div class="line">$ mkdir -p dev_ws/src</div>
</div><!-- fragment --></li>
<li>### 4.2 获取xarm_ros2源码包 <div class="fragment"><div class="line"># 记得先source已安装的ros2环境</div>
<div class="line">$ cd ~/dev_ws/src</div>
<div class="line"># 注意需要--recursive参数，否则不会下载源码包的子模块源码</div>
<div class="line"># 注意使用-b参数指令分支, $ROS_DISTRO表示当前激活的ROS版本，如果没有激活ROS环境，需要自定指定分支(foxy/galactic/humble)</div>
<div class="line">$ git clone https://github.com/xArm-Developer/xarm_ros2.git --recursive -b $ROS_DISTRO</div>
</div><!-- fragment --></li>
<li>### 4.3 升级xarm_ros2源码包 <div class="fragment"><div class="line">$ cd ~/dev_ws/src/xarm_ros2</div>
<div class="line">$ git pull</div>
<div class="line">$ git submodule sync</div>
<div class="line">$ git submodule update --init --remote</div>
</div><!-- fragment --></li>
<li>### 4.4 安装xarm_ros2依赖 <div class="fragment"><div class="line"># 记得先source已安装的ros2环境</div>
<div class="line">$ cd ~/dev_ws/src/</div>
<div class="line">$ rosdep update</div>
<div class="line">$ rosdep install --from-paths . --ignore-src --rosdistro $ROS_DISTRO -y</div>
</div><!-- fragment --></li>
<li>### 4.5 编译xarm_ros2 <div class="fragment"><div class="line"># 记得先source已安装的ros2环境和moveit2环境</div>
<div class="line">$ cd ~/dev_ws/</div>
<div class="line"># 编译所有包</div>
<div class="line">$ colcon build</div>
<div class="line"> </div>
<div class="line"># 编译单个包</div>
<div class="line">$ colcon build --packages-select xarm_api</div>
</div><!-- fragment --></li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md147"></a>
5. 模块说明</h1>
<p><b>注意1： 如果当前局域网有多人使用ros2，为避免相互间发生干扰，请设置一下 ROS_DOMAIN_ID</b> <br  />
</p><ul>
<li><a href="https://docs.ros.org/en/ros2_documentation/foxy/Concepts/About-Domain-ID.html">Foxy</a></li>
<li><a href="https://docs.ros.org/en/ros2_documentation/galactic/Concepts/About-Domain-ID.html">Galactic</a></li>
<li><a href="https://docs.ros.org/en/ros2_documentation/humble/Concepts/About-Domain-ID.html">Humble</a></li>
<li><a href="https://docs.ros.org/en/ros2_documentation/jazzy/Concepts/About-Domain-ID.html">Jazzy</a></li>
</ul>
<p><b>注意2： 运行xarm_ros2中的程序或启动脚本之前请先source当前工作区环境</b> <br  />
 </p><div class="fragment"><div class="line">$ cd ~/dev_ws/</div>
<div class="line">$ source install/setup.bash</div>
</div><!-- fragment --><p> <b>注意3： 以下启动说明以6轴为例，5轴和7轴的用法只需找到对应的启动文件或指定对应的参数</b> <br  />
 <b>注意4: 以下描述的&lt;hw_ns&gt;用实际的替换，xarm系列默认为xarm, 其余的默认为ufactory</b> <br  />
</p>
<ul>
<li>### 5.1 xarm_description 此模块包含机械臂的描述文件，通过以下启动脚本可以在rviz中显示对应的机械臂模型 <div class="fragment"><div class="line">$ cd ~/dev_ws/</div>
<div class="line"># add_gripper为true时会加载xarm夹爪的模型</div>
<div class="line"># add_vacuum_gripper为true时会加载xarm真空吸头的模型</div>
<div class="line"># 注意：只能加载一款末端器件</div>
<div class="line">$ ros2 launch xarm_description xarm6_rviz_display.launch.py [add_gripper:=true] [add_vacuum_gripper:=true]</div>
</div><!-- fragment --></li>
<li>### 5.2 xarm_msgs 此模块包含整个xarm_ros2所使用到的服务和主题通信格式，使用时请查阅每个文件里的说明. <a class="el" href="xarm__msgs_2ReadMe_8md.html">REAEME</a></li>
<li>### 5.3 xarm_sdk 此模块是作为子模块存在的，子模块仓库为<a href="https://github.com/xArm-Developer/xArm-CPLUS-SDK.git">xArm-CPLUS-SDK</a>, 作为控制机械臂的SDK，如需使用请参阅xArm-CPLUS-SDK的文档说明</li>
<li>### 5.4 <a class="el" href="namespacexarm__api.html">xarm_api</a> 此模块是针对xarm_sdk封装，提供对应的ros service和ros topic，整个xarm_ros2是通过使用此模块的service和topic来和机械臂的通信的 所有service和topic默认都处于&lt;hw_ns&gt;/空间，即joint_states的完整名字为&lt;hw_ns&gt;/joint_states<ul>
<li><p class="startli"><b>services</b>: 所有提供的service的名字和SDK中的API名字是对应的，但是否创建对应的服务是根据<span class="tt">xarm_api/config/xarm_params.yaml</span>和<span class="tt">xarm_api/config/xarm_user_params.yaml</span>的services来决定的，只有当services下对应的service的值为<span class="tt">true</span>时才会创建对应的service，如果需要自定义参数，请创建<span class="tt">xarm_api/config/xarm_user_params.yaml</span>文件来修改，格式参照<span class="tt">xarm_api/config/xarm_params.yaml</span>。</p>
<p class="startli"><span class="tt">
        services:
            motion_enable: true
            set_mode: true
            set_state: true
            clean_conf: false
            ...
        </span></p>
</li>
<li><p class="startli"><b>topics</b>: <br  />
</p>
<p class="startli"><b>joint_states</b>: 格式为 <b>sensor_msgs::msg::JointState</b> <br  />
</p>
<p class="startli"><b>robot_states</b>: 格式为 <b>xarm_msgs::msg::RobotMsg</b> <br  />
</p>
<p class="startli"><b>xarm_cgpio_states</b>: 格式为 <b>xarm_msgs::msg::CIOState</b> <br  />
</p>
<p class="startli"><b>uf_ftsensor_raw_states</b>: 格式为 <b>geometry_msgs::msg::WrenchStamped</b> <br  />
</p>
<p class="startli"><b>uf_ftsensor_ext_states</b>: 格式为 <b>geometry_msgs::msg::WrenchStamped</b> <br  />
</p>
<p class="startli"><b>注:</b>: 有些话题需要在launch启动时指定特定的__report_type__才可用，参考<a href="https://github.com/xArm-Developer/xarm_ros#report_type-argument">这里</a>. <br  />
</p>
</li>
<li><b>启动与测试（xArm）</b>: <span class="tt">bash
        $ cd ~/dev_ws/
@section autotoc_md148 启动xarm_driver_node
        $ ros2 launch <a class="el" href="namespacexarm__api.html">xarm_api</a> <a class="el" href="xarm6__driver_8launch_8py.html">xarm6_driver.launch.py</a> robot_ip:=192.168.1.117
@section autotoc_md149 测试service
        $ ros2 run <a class="el" href="namespacexarm__api.html">xarm_api</a> test_xarm_ros_client
@section autotoc_md150 测试topic
        $ ros2 run <a class="el" href="namespacexarm__api.html">xarm_api</a> test_robot_states
        </span></li>
<li><p class="startli"><b>使用命令行（xArm）</b>:</p>
<p class="startli">```bash $ cd ~/dev_ws/ </p>
</li>
</ul>
</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md151"></a>
启动 xarm_driver_node</h1>
<p>$ ros2 launch <a class="el" href="namespacexarm__api.html">xarm_api</a> <a class="el" href="xarm6__driver_8launch_8py.html">xarm6_driver.launch.py</a> robot_ip:=192.168.1.117</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md152"></a>
使能所有关节:</h1>
<p>$ ros2 service call /xarm/motion_enable xarm_msgs/srv/SetInt16ById "{id: 8, data: 1}"</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md153"></a>
设置适当的模式 (0) 和状态 (0)</h1>
<p>$ ros2 service call /xarm/set_mode xarm_msgs/srv/SetInt16 "{data: 0}" $ ros2 service call /xarm/set_state xarm_msgs/srv/SetInt16 "{data: 0}"</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md154"></a>
笛卡尔直线运动: (单位: mm, rad)</h1>
<p>$ ros2 service call /xarm/set_position xarm_msgs/srv/MoveCartesian "{pose: [300, 0, 250, 3.14, 0, 0], speed: 50, acc: 500, mvtime: 0}" <br  />
</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md155"></a>
关节运动 适用xArm6: (单位: rad)</h1>
<p>$ ros2 service call /xarm/set_servo_angle xarm_msgs/srv/MoveJoint "{angles: [-0.58, 0, 0, 0, 0, 0], speed: 0.35, acc: 10, mvtime: 0}" ```</p><ul>
<li><p class="startli"><b>使用命令行（lite6）</b>:</p>
<p class="startli">```bash $ cd ~/dev_ws/ </p>
</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md156"></a>
启动 ufactory_driver_node</h1>
<p>$ ros2 launch <a class="el" href="namespacexarm__api.html">xarm_api</a> <a class="el" href="lite6__driver_8launch_8py.html">lite6_driver.launch.py</a> robot_ip:=192.168.1.161</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md157"></a>
使能所有关节:</h1>
<p>$ ros2 service call /ufactory/motion_enable xarm_msgs/srv/SetInt16ById "{id: 8, data: 1}"</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md158"></a>
设置适当的模式 (0) 和状态 (0)</h1>
<p>$ ros2 service call /ufactory/set_mode xarm_msgs/srv/SetInt16 "{data: 0}" $ ros2 service call /ufactory/set_state xarm_msgs/srv/SetInt16 "{data: 0}"</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md159"></a>
笛卡尔直线运动: (单位: mm, rad)</h1>
<p>$ ros2 service call /ufactory/set_position xarm_msgs/srv/MoveCartesian "{pose: [250, 0, 250, 3.14, 0, 0], speed: 50, acc: 500, mvtime: 0}" <br  />
</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md160"></a>
关节运动: (单位: rad)</h1>
<p>$ ros2 service call /ufactory/set_servo_angle xarm_msgs/srv/MoveJoint "{angles: [-0.58, 0, 0, 0, 0, 0], speed: 0.35, acc: 10, mvtime: 0}" ```</p>
<ul>
<li><p class="startli"><b>使用命令行（UFACTORY850）</b>:</p>
<p class="startli">```bash $ cd ~/dev_ws/ </p>
</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md161"></a>
启动 ufactory_driver_node</h1>
<p>$ ros2 launch <a class="el" href="namespacexarm__api.html">xarm_api</a> <a class="el" href="uf850__driver_8launch_8py.html">uf850_driver.launch.py</a> robot_ip:=192.168.1.181</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md162"></a>
使能所有关节:</h1>
<p>$ ros2 service call /ufactory/motion_enable xarm_msgs/srv/SetInt16ById "{id: 8, data: 1}"</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md163"></a>
设置适当的模式 (0) 和状态 (0)</h1>
<p>$ ros2 service call /ufactory/set_mode xarm_msgs/srv/SetInt16 "{data: 0}" $ ros2 service call /ufactory/set_state xarm_msgs/srv/SetInt16 "{data: 0}"</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md164"></a>
笛卡尔直线运动: (单位: mm, rad)</h1>
<p>$ ros2 service call /ufactory/set_position xarm_msgs/srv/MoveCartesian "{pose: [250, 0, 250, 3.14, 0, 0], speed: 50, acc: 500, mvtime: 0}" <br  />
</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md165"></a>
关节运动: (单位: rad)</h1>
<p>$ ros2 service call /ufactory/set_servo_angle xarm_msgs/srv/MoveJoint "{angles: [-0.58, 0, 0, 0, 0, 0], speed: 0.35, acc: 10, mvtime: 0}" ```</p>
<p>注: 请在使用真机测试之前仔细研究<a href="https://github.com/xArm-Developer/xarm_ros#6-mode-change">Mode</a>, State和可用运动指令的含义。注意**Lite 6与xArm系列提供的服务所在的命名空间不同**。 <br  />
 <b>更详细的服务使用介绍</b>, 请参考<span class="tt"><a class="el" href="namespacexarm__api.html">xarm_api</a></span>目录内的<a class="el" href="xarm__api_2ReadMe_8md.html">ReadMe</a>文档! <br  />
</p>
<ul>
<li>### 5.5 xarm_controller 此模块是ros2_control和机械臂通信的硬件接口模块 <div class="fragment"><div class="line">$ cd ~/dev_ws/</div>
<div class="line"># 对于xArm系列(xarm6举例)：add_gripper为true时会加载xarm夹爪的模型</div>
<div class="line">$ ros2 launch xarm_controller xarm6_control_rviz_display.launch.py robot_ip:=192.168.1.117 [add_gripper:=true]</div>
<div class="line"> </div>
<div class="line"># 对于lite 6: add_gripper为true时会加载Lite夹爪的模型</div>
<div class="line">$ ros2 launch xarm_controller lite6_control_rviz_display.launch.py robot_ip:=192.168.1.161 [add_gripper:=true]</div>
<div class="line"> </div>
<div class="line"># 对于UFACTORY850: add_gripper为true时会加载xarm夹爪的模型</div>
<div class="line">$ ros2 launch xarm_controller uf850_control_rviz_display.launch.launch.py robot_ip:=192.168.1.181 [add_gripper:=true]</div>
</div><!-- fragment --></li>
<li>### 5.6 xarm_moveit_config 此模块提供了通过moveit来控制机械臂的功能<ul>
<li><p class="startli">【虚拟】启动moveit并在rviz显示, 控制机械臂 <br  />
</p>
<p class="startli">```bash $ cd ~/dev_ws/ </p>
</li>
</ul>
</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md166"></a>
对于xArm系列(xarm6举例)：add_gripper为true时会加载xarm夹爪的模型</h1>
<p>$ ros2 launch xarm_moveit_config <a class="el" href="xarm6__moveit__fake_8launch_8py.html">xarm6_moveit_fake.launch.py</a> [add_gripper:=true]</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md167"></a>
对于lite 6: add_gripper为true时会加载Lite夹爪的模型</h1>
<p>$ ros2 launch xarm_moveit_config <a class="el" href="lite6__moveit__fake_8launch_8py.html">lite6_moveit_fake.launch.py</a> [add_gripper:=true]</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md168"></a>
对于UFACTORY850: add_gripper为true时会加载xarm夹爪的模型</h1>
<p>$ ros2 launch xarm_moveit_config <a class="el" href="uf850__moveit__fake_8launch_8py.html">uf850_moveit_fake.launch.py</a> [add_gripper:=true] ```</p>
<ul>
<li><p class="startli">【真机】启动moveit并在rviz显示, 控制机械臂 <br  />
</p>
<p class="startli">```bash $ cd ~/dev_ws/ </p>
</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md169"></a>
对于xArm系列(xarm6举例)：add_gripper为true时会加载xarm夹爪的模型</h1>
<p>$ ros2 launch xarm_moveit_config <a class="el" href="xarm6__moveit__realmove_8launch_8py.html">xarm6_moveit_realmove.launch.py</a> robot_ip:=192.168.1.117 [add_gripper:=true]</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md170"></a>
对于lite 6: add_gripper为true时会加载Lite夹爪的模型</h1>
<p>$ ros2 launch xarm_moveit_config <a class="el" href="lite6__moveit__realmove_8launch_8py.html">lite6_moveit_realmove.launch.py</a> robot_ip:=192.168.1.161 [add_gripper:=true]</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md171"></a>
对于UFACTORY850: add_gripper为true时会加载xarm夹爪的模型</h1>
<p>$ ros2 launch xarm_moveit_config <a class="el" href="uf850__moveit__realmove_8launch_8py.html">uf850_moveit_realmove.launch.py</a> robot_ip:=192.168.1.181 [add_gripper:=true] ```</p>
<ul>
<li><p class="startli">【Dual虚拟】启动moveit并在rviz显示, 控制两台机械臂 <br  />
</p>
<p class="startli">```bash $ cd ~/dev_ws/ </p>
</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md172"></a>
add_gripper为true时会加载xarm夹爪的模型</h1>
<h1 class="doxsection"><a class="anchor" id="autotoc_md173"></a>
add_gripper_1参数可以单独指定左臂是否加载夹爪的模型，默认为add_gripper的值</h1>
<h1 class="doxsection"><a class="anchor" id="autotoc_md174"></a>
add_gripper_2参数可以单独指定右臂是否加载夹爪的模型，默认为add_gripper的值</h1>
<h1 class="doxsection"><a class="anchor" id="autotoc_md175"></a>
dof_1参数可以单独指定左臂轴数，默认为dof的值（这里为6，不同启动脚本不一样）</h1>
<h1 class="doxsection"><a class="anchor" id="autotoc_md176"></a>
dof_2参数可以单独指定右臂轴数，默认为dof的值（这里为6，不同启动脚本不一样）</h1>
<h1 class="doxsection"><a class="anchor" id="autotoc_md177"></a>
对于xArm系列（xarm6）：</h1>
<p>$ ros2 launch xarm_moveit_config <a class="el" href="dual__xarm6__moveit__fake_8launch_8py.html">dual_xarm6_moveit_fake.launch.py</a> [add_gripper:=true]</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md178"></a>
对于Lite6：</h1>
<p>$ ros2 launch xarm_moveit_config <a class="el" href="dual__lite6__moveit__fake_8launch_8py.html">dual_lite6_moveit_fake.launch.py</a> [add_gripper:=true]</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md179"></a>
对于UFACTORY850：</h1>
<p>$ ros2 launch xarm_moveit_config <a class="el" href="dual__uf850__moveit__fake_8launch_8py.html">dual_uf850_moveit_fake.launch.py</a> [add_gripper:=true] ```</p>
<ul>
<li><p class="startli">【Dual真机】启动moveit并在rviz显示, 控制两台机械臂 <br  />
</p>
<p class="startli">```bash $ cd ~/dev_ws/ </p>
</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md180"></a>
robot_ip_1表示左臂控制的IP地址</h1>
<h1 class="doxsection"><a class="anchor" id="autotoc_md181"></a>
robot_ip_2表示右臂控制的IP地址</h1>
<h1 class="doxsection"><a class="anchor" id="autotoc_md182"></a>
add_gripper为true时会加载xarm夹爪的模型</h1>
<h1 class="doxsection"><a class="anchor" id="autotoc_md183"></a>
add_gripper_1参数可以单独指定左臂是否加载夹爪的模型，默认为add_gripper的值</h1>
<h1 class="doxsection"><a class="anchor" id="autotoc_md184"></a>
add_gripper_2参数可以单独指定右臂是否加载夹爪的模型，默认为add_gripper的值</h1>
<h1 class="doxsection"><a class="anchor" id="autotoc_md185"></a>
dof_1参数可以单独指定左臂轴数，默认为dof的值（这里为6，不同启动脚本不一样）</h1>
<h1 class="doxsection"><a class="anchor" id="autotoc_md186"></a>
dof_2参数可以单独指定右臂轴数，默认为dof的值（这里为6，不同启动脚本不一样）</h1>
<h1 class="doxsection"><a class="anchor" id="autotoc_md187"></a>
对于xArm系列（xarm6）：</h1>
<p>$ ros2 launch xarm_moveit_config <a class="el" href="dual__xarm6__moveit__realmove_8launch_8py.html">dual_xarm6_moveit_realmove.launch.py</a> robot_ip_1_1:=192.168.1.117 robot_ip_2:=192.168.1.203 [add_gripper:=true]</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md188"></a>
对于Lite6：</h1>
<p>$ ros2 launch xarm_moveit_config <a class="el" href="dual__lite6__moveit__realmove_8launch_8py.html">dual_lite6_moveit_realmove.launch.py</a> robot_ip_1_1:=192.168.1.117 robot_ip_2:=192.168.1.203 [add_gripper:=true]</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md189"></a>
对于UFACTORY850：</h1>
<p>$ ros2 launch xarm_moveit_config <a class="el" href="dual__uf850__moveit__realmove_8launch_8py.html">dual_uf850_moveit_realmove.launch.py</a> robot_ip_1_1:=192.168.1.181 robot_ip_2:=192.168.1.182 [add_gripper:=true] ```</p>
<ul>
<li>### 5.7 <a class="el" href="namespacexarm__planner.html">xarm_planner</a> 此模块提供了通过moveit API控制机械臂 <div class="fragment"><div class="line">$ cd ~/dev_ws/</div>
<div class="line"># 【虚拟xArm】启动xarm_planner_node</div>
<div class="line">$ ros2 launch xarm_planner xarm6_planner_fake.launch.py [add_gripper:=true]</div>
<div class="line"># 【xArm真机】启动xarm_planner_node</div>
<div class="line">$ ros2 launch xarm_planner xarm6_planner_realmove.launch.py robot_ip:=192.168.1.117 [add_gripper:=true]</div>
<div class="line"> </div>
<div class="line"># 【虚拟lite6】启动xarm_planner_node</div>
<div class="line">$ ros2 launch xarm_planner lite6_planner_fake.launch.py [add_gripper:=true]</div>
<div class="line"># 【lite6真机】启动xarm_planner_node</div>
<div class="line">$ ros2 launch xarm_planner lite6_planner_realmove.launch.py robot_ip:=192.168.1.117 [add_gripper:=true]</div>
<div class="line"> </div>
<div class="line"># 【虚拟UFACTORY850】启动xarm_planner_node</div>
<div class="line">$ ros2 launch xarm_planner uf850_planner_fake.launch.py [add_gripper:=true]</div>
<div class="line"># 【UFACTORY850真机】启动xarm_planner_node</div>
<div class="line">$ ros2 launch xarm_planner uf850_planner_realmove.launch.py robot_ip:=192.168.1.181 [add_gripper:=true]</div>
<div class="line"> </div>
<div class="line"># 运行测试(通过API控制, 根据系列型号指定robot_type为xarm或lite或uf850)</div>
<div class="line">$ ros2 launch xarm_planner test_xarm_planner_api_joint.launch.py dof:=6 robot_type:=&lt;xarm | lite | uf850&gt;</div>
<div class="line">$ ros2 launch xarm_planner test_xarm_planner_api_pose.launch.py dof:=6 robot_type:=&lt;xarm | lite | uf850&gt;</div>
</div><!-- fragment --> 以下这些测试目前仅适用于xArm: <div class="fragment"><div class="line"># 运行测试（通过service控制）</div>
<div class="line">$ ros2 launch xarm_planner test_xarm_planner_client_joint.launch.py dof:=6</div>
<div class="line">$ ros2 launch xarm_planner test_xarm_planner_client_pose.launch.py dof:=6</div>
<div class="line"> </div>
<div class="line"># 运行测试（通过API控制机械爪）</div>
<div class="line">$ ros2 launch xarm_planner test_xarm_gripper_planner_api_joint.launch.py dof:=6</div>
<div class="line"> </div>
<div class="line"># 运行测试（通过service控制机械爪）</div>
<div class="line">$ ros2 launch xarm_planner test_xarm_gripper_planner_client_joint.launch.py dof:=6</div>
</div><!-- fragment --></li>
<li>### 5.8 xarm_gazebo 此模块用于在gazobo上对xarm进行仿真。 <br  />
 注意： <br  />
 (1) 可能需要源码安装<a href="https://github.com/ros-simulation/gazebo_ros2_control.git">gazebo_ros2_control</a>，并source所安装的gazebo_ros2_control环境。 <br  />
 (2) <a href="https://github.com/roboticsgroup/roboticsgroup_upatras_gazebo_plugins">minic_joint_plugin</a>是基于ROS1开发，我们基于此修改并集成了ROS2兼容的插件版本，供xArm Gripper仿真使用。 <br  />
<ul>
<li>单独测试xarm在gazebo上的显示： ```bash $ cd ~/dev_ws/ </li>
</ul>
</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md190"></a>
对于xArm系列（xarm6）：</h1>
<p>$ ros2 launch xarm_gazebo <a class="el" href="xarm6__beside__table__gazebo_8launch_8py.html">xarm6_beside_table_gazebo.launch.py</a></p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md191"></a>
对于Lite6：</h1>
<p>$ ros2 launch xarm_gazebo <a class="el" href="lite6__beside__table__gazebo_8launch_8py.html">lite6_beside_table_gazebo.launch.py</a></p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md192"></a>
对于UFACTORY850：</h1>
<p>$ ros2 launch xarm_gazebo <a class="el" href="uf850__beside__table__gazebo_8launch_8py.html">uf850_beside_table_gazebo.launch.py</a> ```</p>
<ul>
<li>联合moveit+gazebo进行控制： ```bash $ cd ~/dev_ws/ </li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md193"></a>
对于xArm系列（xarm6）：</h1>
<p>$ ros2 launch xarm_moveit_config <a class="el" href="xarm6__moveit__gazebo_8launch_8py.html">xarm6_moveit_gazebo.launch.py</a></p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md194"></a>
对于Lite6：</h1>
<p>$ ros2 launch xarm_moveit_config <a class="el" href="lite6__moveit__gazebo_8launch_8py.html">lite6_moveit_gazebo.launch.py</a></p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md195"></a>
对于UFACTORY850：</h1>
<p>$ ros2 launch xarm_moveit_config <a class="el" href="uf850__moveit__gazebo_8launch_8py.html">uf850_moveit_gazebo.launch.py</a> ```</p>
<ul>
<li>### 5.9 <a class="el" href="namespacexarm__moveit__servo.html">xarm_moveit_servo</a> 此模块用于通过外部输入来控制机械臂, 基于<a href="http://moveit2_tutorials.picknik.ai/doc/realtime_servo/realtime_servo_tutorial.html">moveit_servo</a>。 <br  />
<ul>
<li><p class="startli">通过 <b>XBOX360</b> 手柄控制</p><ul>
<li>左摇杆控制TCP的X和Y</li>
<li>右摇杆控制TCP的ROLL和PITCH</li>
<li>[前面]左右两个触发器控制TCP的Z</li>
<li>[前面]左右两个缓冲器控制TCP的YAW</li>
<li>十字键控制关节1和关节2的转动</li>
<li>按键X和按键B控制最后一个关节的转动</li>
<li>按键Y和按键A控制倒数第二个关节的转动</li>
</ul>
<p class="startli">```bash $ cd ~/dev_ws/ </p>
</li>
</ul>
</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md196"></a>
XBOX Wired -&gt; joystick_type=1</h1>
<h1 class="doxsection"><a class="anchor" id="autotoc_md197"></a>
XBOX Wireless -&gt; joystick_type=2</h1>
<h1 class="doxsection"><a class="anchor" id="autotoc_md198"></a>
控制虚拟xArm6机械臂</h1>
<p>$ ros2 launch <a class="el" href="namespacexarm__moveit__servo.html">xarm_moveit_servo</a> <a class="el" href="xarm__moveit__servo__fake_8launch_8py.html">xarm_moveit_servo_fake.launch.py</a> joystick_type:=1 </p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md199"></a>
或者控制虚拟Lite6:</h1>
<p>$ ros2 launch <a class="el" href="namespacexarm__moveit__servo.html">xarm_moveit_servo</a> <a class="el" href="lite6__moveit__servo__fake_8launch_8py.html">lite6_moveit_servo_fake.launch.py</a> joystick_type:=1 </p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md200"></a>
或者控制虚拟UFACTORY850:</h1>
<p>$ ros2 launch <a class="el" href="namespacexarm__moveit__servo.html">xarm_moveit_servo</a> <a class="el" href="uf850__moveit__servo__fake_8launch_8py.html">uf850_moveit_servo_fake.launch.py</a> joystick_type:=1</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md201"></a>
控制真实xArm5机械臂</h1>
<p>$ ros2 launch <a class="el" href="namespacexarm__moveit__servo.html">xarm_moveit_servo</a> <a class="el" href="xarm__moveit__servo__realmove_8launch_8py.html">xarm_moveit_servo_realmove.launch.py</a> robot_ip:=192.168.1.123 dof:=5 joystick_type:=1 </p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md202"></a>
或者控制真实Lite6:</h1>
<p>$ ros2 launch <a class="el" href="namespacexarm__moveit__servo.html">xarm_moveit_servo</a> <a class="el" href="lite6__moveit__servo__realmove_8launch_8py.html">lite6_moveit_servo_realmove.launch.py</a> robot_ip:=192.168.1.123 joystick_type:=1 </p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md203"></a>
或者控制真实UFACTORY850:</h1>
<p>$ ros2 launch <a class="el" href="namespacexarm__moveit__servo.html">xarm_moveit_servo</a> <a class="el" href="uf850__moveit__servo__realmove_8launch_8py.html">uf850_moveit_servo_realmove.launch.py</a> robot_ip:=192.168.1.181 joystick_type:=1 ```</p>
<ul>
<li><p class="startli">通过六维鼠标 <b>3Dconnexion SpaceMouse Wireless</b> 来控制</p><ul>
<li>六维鼠标的六个维度对应控制TCP的X/Y/Z/ROLL/PITCH/YAW</li>
<li>左边按键按下时单独控制TCP的XYZ</li>
<li>右边按键按下时单独控制TCP的ROLL/PITCH/YAW</li>
</ul>
<p class="startli">```bash $ cd ~/dev_ws/ </p>
</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md204"></a>
控制虚拟xArm6机械臂</h1>
<p>$ ros2 launch <a class="el" href="namespacexarm__moveit__servo.html">xarm_moveit_servo</a> <a class="el" href="xarm__moveit__servo__fake_8launch_8py.html">xarm_moveit_servo_fake.launch.py</a> joystick_type:=3 </p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md205"></a>
或者控制虚拟Lite6:</h1>
<p>$ ros2 launch <a class="el" href="namespacexarm__moveit__servo.html">xarm_moveit_servo</a> <a class="el" href="lite6__moveit__servo__fake_8launch_8py.html">lite6_moveit_servo_fake.launch.py</a> joystick_type:=3 </p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md206"></a>
或者控制虚拟UFACTORY850:</h1>
<p>$ ros2 launch <a class="el" href="namespacexarm__moveit__servo.html">xarm_moveit_servo</a> <a class="el" href="uf850__moveit__servo__fake_8launch_8py.html">uf850_moveit_servo_fake.launch.py</a> joystick_type:=3</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md207"></a>
控制真实xArm5机械臂</h1>
<p>$ ros2 launch <a class="el" href="namespacexarm__moveit__servo.html">xarm_moveit_servo</a> <a class="el" href="xarm__moveit__servo__realmove_8launch_8py.html">xarm_moveit_servo_realmove.launch.py</a> robot_ip:=192.168.1.123 dof:=5 joystick_type:=3 </p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md208"></a>
或者控制真实Lite6:</h1>
<p>$ ros2 launch <a class="el" href="namespacexarm__moveit__servo.html">xarm_moveit_servo</a> <a class="el" href="xarm__moveit__servo__realmove_8launch_8py.html">xarm_moveit_servo_realmove.launch.py</a> robot_ip:=192.168.1.123 dof:=6 robot_type:=lite joystick_type:=3 </p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md209"></a>
或者控制真实UFACTORY850:</h1>
<p>$ ros2 launch <a class="el" href="namespacexarm__moveit__servo.html">xarm_moveit_servo</a> <a class="el" href="uf850__moveit__servo__realmove_8launch_8py.html">uf850_moveit_servo_realmove.launch.py</a> robot_ip:=192.168.1.181 joystick_type:=3 <span class="tt"></p><ul>
<li>通过 __键盘输入__ 控制
        </li>
</ul>
<p></span>bash $ cd ~/dev_ws/ </p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md210"></a>
控制虚拟xArm6机械臂</h1>
<p>$ ros2 launch <a class="el" href="namespacexarm__moveit__servo.html">xarm_moveit_servo</a> <a class="el" href="xarm__moveit__servo__fake_8launch_8py.html">xarm_moveit_servo_fake.launch.py</a> </p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md211"></a>
或者控制虚拟Lite6:</h1>
<p>$ ros2 launch <a class="el" href="namespacexarm__moveit__servo.html">xarm_moveit_servo</a> <a class="el" href="lite6__moveit__servo__fake_8launch_8py.html">lite6_moveit_servo_fake.launch.py</a> </p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md212"></a>
或者控制虚拟UFACTORY850:</h1>
<p>$ ros2 launch <a class="el" href="namespacexarm__moveit__servo.html">xarm_moveit_servo</a> <a class="el" href="uf850__moveit__servo__fake_8launch_8py.html">uf850_moveit_servo_fake.launch.py</a></p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md213"></a>
控制真实xArm5机械臂</h1>
<p>$ ros2 launch <a class="el" href="namespacexarm__moveit__servo.html">xarm_moveit_servo</a> <a class="el" href="xarm__moveit__servo__realmove_8launch_8py.html">xarm_moveit_servo_realmove.launch.py</a> robot_ip:=192.168.1.123 dof:=5 </p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md214"></a>
或者控制真实Lite6:</h1>
<p>$ ros2 launch <a class="el" href="namespacexarm__moveit__servo.html">xarm_moveit_servo</a> <a class="el" href="lite6__moveit__servo__realmove_8launch_8py.html">lite6_moveit_servo_realmove.launch.py</a> robot_ip:=192.168.1.123 </p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md215"></a>
或者控制真实UFACTORY850:</h1>
<p>$ ros2 launch <a class="el" href="namespacexarm__moveit__servo.html">xarm_moveit_servo</a> <a class="el" href="uf850__moveit__servo__realmove_8launch_8py.html">uf850_moveit_servo_realmove.launch.py</a> robot_ip:=192.168.1.181</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md216"></a>
之后在另一个终端，运行键盘输入响应节点</h1>
<p>$ ros2 run <a class="el" href="namespacexarm__moveit__servo.html">xarm_moveit_servo</a> xarm_keyboard_input ```</p><ul>
<li>### 5.10 xarm_vision 提供xArm扩展视觉应用的基础示例，包括手眼标定和视觉抓取，例程主要基于<a href="https://www.intelrealsense.com/depth-camera-d435i/">Intel RealSense D435i</a>深度相机。<ul>
<li>#### 5.10.1 相关依赖库和ros包的安装：<ul>
<li>首先进入ros工作空间： <span class="tt">bash
            $ cd ~/dev_ws/src/
            </span></li>
<li>##### 安装RealSense 开发支持库和ROS软件包： 请依照<a href="https://github.com/IntelRealSense/realsense-ros/tree/ros2-master">官方指示步骤</a>正确安装。 <span class="tt">bash
            $ git clone -b ros2-master <a href="https://github.com/IntelRealSense/realsense-ros.git">https://github.com/IntelRealSense/realsense-ros.git</a>
            </span></li>
<li>##### 安装aruco_ros, 用于手眼标定： 参考<a href="https://github.com/pal-robotics/aruco_ros/tree/humble-devel">官方Github</a>: <span class="tt">bash
            $ git clone -b humble-devel <a href="https://github.com/pal-robotics/aruco_ros.git">https://github.com/pal-robotics/aruco_ros.git</a>
            </span></li>
<li>##### 安装easy_handeye2, 用于手眼标定： 参考<a href="https://github.com/marcoesposito1988/easy_handeye2">官方Github</a>: <span class="tt">bash
            $ git clone <a href="https://github.com/marcoesposito1988/easy_handeye2.git">https://github.com/marcoesposito1988/easy_handeye2.git</a>
            </span></li>
<li>##### 安装find_object_2d包，用于物体识别： 参考<a href="https://github.com/introlab/find-object/tree/humble-devel">官方Github</a>: <span class="tt">bash
            $ sudo apt-get install ros-humble-find-object-2d
            </span></li>
<li>##### 安装其他依赖包： <span class="tt">bash
            $ cd ~/dev_ws/src
            $ rosdep update
            $ rosdep install --from-paths . --ignore-src --rosdistro $ROS_DISTRO -y
            </span></li>
<li>##### 编译整个工作区： <span class="tt">bash
            $ colcon build
            </span></li>
</ul>
</li>
<li><p class="startli">#### 5.10.2 手眼标定示例： 如果使用RealSense D435i相机配合固定工件安装在手臂末端，即“**眼在手上**”，确保相机与电脑通信正常且手臂正常上电后，可以参考和使用如下launch脚本进行手眼标定： <span class="tt">bash
@section autotoc_md217 xArm 5/6/7
        $ ros2 launch d435i_xarm_setup <a class="el" href="d435i__robot__auto__calib_8launch_8py.html">d435i_robot_auto_calib.launch.py</a> robot_type:=xarm dof:=your_xArm_DOF robot_ip:=your_xArm_IP
@section autotoc_md218 Lite6
        $ ros2 launch d435i_xarm_setup <a class="el" href="d435i__robot__auto__calib_8launch_8py.html">d435i_robot_auto_calib.launch.py</a> robot_type:=lite dof:=6 robot_ip:=your_xArm_IP
@section autotoc_md219 UFACTORY850
        $ ros2 launch d435i_xarm_setup <a class="el" href="d435i__robot__auto__calib_8launch_8py.html">d435i_robot_auto_calib.launch.py</a> robot_type:=uf850 dof:=6 robot_ip:=your_xArm_IP
        </span> 注意: 对于**2023年8月之后**生产的xArm/UF850系列型号, 可以选择将运动学校准参数加入到URDF模型中, 在以上的launch命令中使用<span class="tt">kinematics_suffix</span>参数来提高标定的准确度。 <br  />
</p>
<p class="startli">标定使用的aruco二维码可以在<a href="https://chev.me/arucogen/">这里下载</a>，请记住自己下载的<span class="tt">marker ID</span>和<span class="tt">marker size</span>，并在以上launch文件中修改。参考<a href="https://github.com/IFL-CAMP/easy_handeye#calibration">官方</a>或其他网络教程通过图形界面进行标定，标定完成并确认保存后，默认会在 <span class="tt">~/.ros2/easy_handeye2/calibrations/</span>目录下生成&lt;tt&gt;.calib</p>
</li>
</ul>
</li>
</ul>
<p>后缀的结果文档，供后续与手臂一起进行坐标变换使用。如果固定件用的是UFACTORY提供的<a href="https://www.ufactory.cc/products/xarm-camera-module-2020">camera_stand</a>，在<span class="tt">xarm_vision/d435i_xarm_setup/config/</span>目录中保存了参考的标定结果。</p>
<h5 class="doxsection"><a class="anchor" id="autotoc_md220"></a>
手眼标定注意事项:</h5>
<p>由于<span class="tt">easy_handeye2</span>默认不生成机械臂位置，我们可以在上述命令启动后，通过xarm studio控制界面或者开启拖动示教认为控制机械臂到不同位置，然后通过启动的手眼标定窗口的"__Take Sample__"采集数据，采集后会自动计算结果，采集到大概17个数据后通过"__Save__"保存(默认保存在<span class="tt">~/.ros2/easy_handeye2/calibrations/</span>)，每次采集时机械臂的位置建议在保证标定板在视野范围内尽量多旋转rpy</p><ul>
<li>两次运动的旋转轴的夹角越大越好</li>
<li>每次运动的旋转矩阵对应的旋转角度越大越好</li>
<li>相机中心到标定板的距离越小越好</li>
<li>每次运动机械臂末端运动的距离越小越好</li>
</ul>
<p>#### 5.10.3 3D视觉抓取示例： 本部分提供利用<a href="http://introlab.github.io/find-object/"><em><b>find_object_2d</b></em></a>进行简单的物体识别和抓取的示例程序。使用了RealSense D435i深度相机，UFACTORY camera_stand以及xArm官方机械爪(<b>Lite6用的是吸头</b>)。 <br  />
</p>
<p>1.使用moveit驱动手臂动作，如果规划成功会保证无碰撞和奇异点的轨迹执行, 但对网络通信稳定性要求较高： ```bash </p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md221"></a>
xArm 5/6/7</h1>
<p>$ ros2 launch d435i_xarm_setup <a class="el" href="d435i__findobj2d__robot__moveit__planner_8launch_8py.html">d435i_findobj2d_robot_moveit_planner.launch.py</a> robot_type=xarm dof:=your_xArm_DOF robot_ip:=your_xArm_IP </p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md222"></a>
Lite6</h1>
<p>$ ros2 launch d435i_xarm_setup <a class="el" href="d435i__findobj2d__robot__moveit__planner_8launch_8py.html">d435i_findobj2d_robot_moveit_planner.launch.py</a> robot_type=lite dof:=6 robot_ip:=your_xArm_IP </p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md223"></a>
UFACTORY850</h1>
<p>$ ros2 launch d435i_xarm_setup <a class="el" href="d435i__findobj2d__robot__moveit__planner_8launch_8py.html">d435i_findobj2d_robot_moveit_planner.launch.py</a> robot_type=uf850 dof:=6 robot_ip:=your_xArm_IP</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md224"></a>
默认使用的标定参数是~/.ros2/easy_handeye2/calibrations/{robot_type}_rs_on_hand_calibration.calib</h1>
<h1 class="doxsection"><a class="anchor" id="autotoc_md225"></a>
如果需要指定启动参数calib_filename, 将使用d435i_xarm_setup/config/{calib_filename}.calib文件记录的标定参数</h1>
<p><span class="tt">
        如果目标物体可以正常识别，执行抓取节点:  \ilinebr&lt;br&gt;
        </span>bash </p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md226"></a>
xArm 5/6/7</h1>
<p>$ ros2 launch d435i_xarm_setup <a class="el" href="grasp__node__robot__moveit__planner_8launch_8py.html">grasp_node_robot_moveit_planner.launch.py</a> robot_type=xarm dof:=your_xArm_DOF </p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md227"></a>
Lite6</h1>
<p>$ ros2 launch d435i_xarm_setup <a class="el" href="grasp__node__robot__moveit__planner_8launch_8py.html">grasp_node_robot_moveit_planner.launch.py</a> robot_type=lite dof:=6 </p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md228"></a>
UFACTORY850</h1>
<p>$ ros2 launch d435i_xarm_setup <a class="el" href="grasp__node__robot__moveit__planner_8launch_8py.html">grasp_node_robot_moveit_planner.launch.py</a> robot_type=uf850 dof:=6 ``` 节点代码可以参考d435i_xarm_setup/src/<a href="./xarm_vision/d435i_xarm_setup/src/findobj_grasp_moveit_planner.cpp">findobj_grasp_moveit_planner.cpp</a>. <br  />
</p>
<p>2.或者使用xarm_api提供的ros service驱动手臂动作，网络稳定性要求不高，但部分时候执行过程中可能报错（奇异点或将要发生自碰撞等）： ```bash </p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md229"></a>
xArm 5/6/7</h1>
<p>$ ros2 launch d435i_xarm_setup <a class="el" href="d435i__findobj2d__robot__api_8launch_8py.html">d435i_findobj2d_robot_api.launch.py</a> robot_type=xarm dof:=your_xArm_DOF robot_ip:=your_xArm_IP </p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md230"></a>
Lite6</h1>
<p>$ ros2 launch d435i_xarm_setup <a class="el" href="d435i__findobj2d__robot__api_8launch_8py.html">d435i_findobj2d_robot_api.launch.py</a> robot_type=lite dof:=6 robot_ip:=your_xArm_IP </p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md231"></a>
UFACTORY850</h1>
<p>$ ros2 launch d435i_xarm_setup <a class="el" href="d435i__findobj2d__robot__api_8launch_8py.html">d435i_findobj2d_robot_api.launch.py</a> robot_type=uf850 dof:=6 robot_ip:=your_xArm_IP</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md232"></a>
默认使用的标定参数是~/.ros2/easy_handeye2/calibrations/{robot_type}_rs_on_hand_calibration.calib</h1>
<h1 class="doxsection"><a class="anchor" id="autotoc_md233"></a>
如果需要指定启动参数calib_filename, 将使用d435i_xarm_setup/config/{calib_filename}.calib文件记录的标定参数</h1>
<p><span class="tt">
        如果目标物体可以正常识别，执行抓取节点:  \ilinebr&lt;br&gt;
        </span>bash </p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md234"></a>
xArm 5/6/7</h1>
<p>$ ros2 launch d435i_xarm_setup <a class="el" href="grasp__node__robot__api_8launch_8py.html">grasp_node_robot_api.launch.py</a> robot_type=xarm dof:=your_xArm_DOF </p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md235"></a>
Lite6</h1>
<p>$ ros2 launch d435i_xarm_setup <a class="el" href="grasp__node__robot__api_8launch_8py.html">grasp_node_robot_api.launch.py</a> robot_type=lite dof:=6 </p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md236"></a>
UFACTORY850</h1>
<p>$ ros2 launch d435i_xarm_setup <a class="el" href="grasp__node__robot__api_8launch_8py.html">grasp_node_robot_api.launch.py</a> robot_type=uf850 dof:=6 ``` 节点代码可以参考d435i_xarm_setup/src/<a href="./xarm_vision/d435i_xarm_setup/src/findobj_grasp_xarm_api.cpp">findobj_grasp_xarm_api.cpp</a>.</p>
<p>***实际应用之前，请先读懂对应的代码，并针对自己的场景做出必要的修改***，比如抓取准备位置，姿态，抓取深度以及移动速度等等。代码中使用的识别目标名称为“object_1”，对应/objects目录下的<span class="tt">1.png</span>，用户可以根据实际应用在find_object_2d的图形界面中添加新的目标并修改节点程序中的<span class="tt">source_frame</span>，来识别感兴趣的物体。 <br  />
</p>
<p><em><b>Tips</b></em>: 应注意背景尽量干净而且颜色与被识别物体有区分度，如果目标物体有比较丰富的文理，识别率会更高。</p>
<ul>
<li>#### 7.4 在仿真的xArm模型末端添加RealSense D435i模型： 如果使用UFACTORY提供的camera stand固定，可以通过以下设置添加到虚拟模型（以xarm7为例）： <br  />
 <span class="tt">bash
        $ ros2 launch xarm_moveit_config xarm7_moveit_fake.launch add_realsense_d435i:=true
        </span></li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md237"></a>
6. 主要启动参数说明</h2>
<ul>
<li><b>robot_ip</b> 机械臂IP地址，控制真机时需要。 <br  />
</li>
<li><b>report_type</b>, 默认normal。 <br  />
 上报类型，支持normal/rich/dev， <br  />
 不同上报类型的上报数据和上报频率不一样。 <br  />
</li>
<li><b>dof</b>, 默认为7。 机械臂轴数，如非必须参数一般不需要指定。 <br  />
 对于双臂启动脚本(dual_开头的)，可以通过以下参数分别指定：<ul>
<li><b>dof_1</b></li>
<li><b>dof_2</b></li>
</ul>
</li>
<li><b>velocity_control</b>, 默认为false。 <br  />
 是否使用速度控制。 <br  />
</li>
<li><b>add_realsense_d435i</b>, 默认为false。 <br  />
 是否在末端加载realsense D435i摄像头模型。 <br  />
 对于双臂启动脚本(dual_开头的)，可以通过以下参数分别指定： <br  />
<ul>
<li><b>add_realsense_d435i_1</b></li>
<li><b>add_realsense_d435i_2</b></li>
</ul>
</li>
<li><b>add_gripper</b>, 默认为false。 <br  />
 是否添加UF机械爪xarm_gripper，优先级高于参数<span class="tt">add_vacuum_gripper</span>。 对于双臂启动脚本(dual_开头的)，可以通过以下参数分别指定： <br  />
<ul>
<li><b>add_gripper_1</b></li>
<li><b>add_gripper_2</b></li>
</ul>
</li>
<li><b>add_bio_gripper</b>, 默认为false。 <br  />
 是否添加BIO机械爪bio_gripper，优先级高于参数<span class="tt">add_vacuum_gripper</span>, 设置为true的前提必须要设置参数<span class="tt">add_gripper</span>为<span class="tt">false</span>。 对于双臂启动脚本(dual_开头的)，可以通过以下参数分别指定： <br  />
<ul>
<li><b>add_bio_gripper_1</b></li>
<li><b>add_bio_gripper_2</b></li>
</ul>
</li>
<li><b>add_vacuum_gripper</b>, 默认为false。 <br  />
 是否添加UF吸泵xarm_vacuum_gripper，设置为true的前提必须要设置参数<span class="tt">add_gripper</span>为<span class="tt">false</span> 对于双臂启动脚本(dual_开头的)，可以通过以下参数分别指定： <br  />
<ul>
<li><b>add_vacuum_gripper_1</b></li>
<li><b>add_vacuum_gripper_2</b></li>
</ul>
</li>
<li><p class="startli"><b>add_other_geometry</b>, 默认为false。 <br  />
 是否添加其它几何模型到末端，设置为true的前提:参数<span class="tt">add_gripper</span>和<span class="tt">add_vacuum_gripper</span>必须为<span class="tt">false</span> <br  />
</p><ul>
<li><b>geometry_type</b>, 默认为box, 仅仅在<span class="tt">add_other_geometry=true</span>时有效。 要添加的几何模型的类型，支持box/cylinder/sphere/mesh。</li>
<li><b>geometry_mass</b>, 单位(kg)，默认0.1。 <br  />
 几何模型质量。</li>
<li><b>geometry_height</b>, 单位(米)，默认0.1。 <br  />
 几何模型高度，geometry_type为box/cylinder/sphere有效。</li>
<li><b>geometry_radius</b>, 单位(米)，默认0.1。 <br  />
 几何模型半径，geometry_type为cylinder/sphere有效。</li>
<li><b>geometry_length</b>, 单位(米)，默认0.1。 几何模型长度，geometry_type为box有效。</li>
<li><b>geometry_width</b>, 单位(米)，默认0.1。 几何模型宽度，geometry_type为box有效。</li>
<li><b>geometry_mesh_filename</b>, 几何模型的文件名，geometry_type为mesh有效, ***该文件需要存放于<span class="tt">xarm_description/meshes/other/</span>目录下面***，这样就不需要在文件名里指定文件目录了。 <br  />
</li>
<li><b>geometry_mesh_origin_xyz</b>, 默认"0 0 0"</li>
<li><b>geometry_mesh_origin_rpy</b>, 默认"0 0 0" 几何模型的基准参考系相对于xArm末端法兰的参考系，geometry_type为 <span class="tt">mesh</span>有效。使用时注意引号: geometry_mesh_origin_xyz:='"0.05 0.0 0.0"'. <br  />
</li>
<li><b>geometry_mesh_tcp_xyz</b>, 默认"0 0 0"</li>
<li><b>geometry_mesh_tcp_rpy</b>, 默认"0 0 0" 几何模型末端(TCP)相对于几何模型基准参考系的偏移，geometry_type为<span class="tt">mesh</span>有效。使用时注意引号: geometry_mesh_tcp_rpy:='"0.0 0.0 1.5708"'. <br  />
</li>
<li><p class="startli"><b>添加自定义末端工具(圆柱体)示例</b> <br  />
</p>
<p class="startli"><span class="tt">bash
        $ ros2 launch xarm_gazebo <a class="el" href="xarm6__beside__table__gazebo_8launch_8py.html">xarm6_beside_table_gazebo.launch.py</a> add_other_geometry:=true geometry_type:=cylinder geometry_height:=0.075 geometry_radius:=0.045
        </span></p>
</li>
</ul>
<p class="startli">对于双臂启动脚本(dual_开头的)，可以通过以下参数分别指定:</p><ul>
<li><b>add_other_geometry_1</b></li>
<li><b>add_other_geometry_2</b></li>
<li><b>geometry_type_1</b></li>
<li><b>geometry_type_2</b></li>
<li><b>geometry_mass_1</b></li>
<li><b>geometry_mass_2</b></li>
<li><b>geometry_height_1</b></li>
<li><b>geometry_height_2</b></li>
<li><b>geometry_radius_1</b>,</li>
<li><b>geometry_radius_2</b>,</li>
<li><b>geometry_length_1</b></li>
<li><b>geometry_length_2</b></li>
<li><b>geometry_width_1</b></li>
<li><b>geometry_width_2</b></li>
<li><b>geometry_mesh_filename_1</b></li>
<li><b>geometry_mesh_filename_2</b></li>
<li><b>geometry_mesh_origin_xyz_1</b></li>
<li><b>geometry_mesh_origin_xyz_2</b></li>
<li><b>geometry_mesh_origin_rpy_1</b></li>
<li><b>geometry_mesh_origin_rpy_2</b></li>
<li><b>geometry_mesh_tcp_xyz_1</b></li>
<li><b>geometry_mesh_tcp_xyz_2</b></li>
<li><b>geometry_mesh_tcp_rpy_1</b></li>
<li><b>geometry_mesh_tcp_rpy_2</b></li>
</ul>
</li>
<li><b>kinematics_suffix</b>: 指定关节Kinematics参数文件后缀<ul>
<li>参数文件的生成: ```bash cd src/xarm_ros/xarm_description/config/kinematics python <a class="el" href="gen__kinematics__params_8py.html">gen_kinematics_params.py</a> {robot_ip} {kinematics_suffix}</li>
</ul>
</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md238"></a>
注意</h1>
<h1 class="doxsection"><a class="anchor" id="autotoc_md239"></a>
1. robot_ip表示机械臂IP，需要连接机械臂获取实际的参数</h1>
<h1 class="doxsection"><a class="anchor" id="autotoc_md240"></a>
2. kinematics_suffix表示生成的参数文件的后缀，如果成功，会在xarm_description/config/kinematics/user目录下生成配置文件, 假如 kinematics_suffix 为 AAA, 那么对应的文件名如下</h1>
<h1 class="doxsection"><a class="anchor" id="autotoc_md241"></a>
xarm5: xarm_description/config/kinematics/user/xarm5_kinematics_AAA.yaml</h1>
<h1 class="doxsection"><a class="anchor" id="autotoc_md242"></a>
xarm6: xarm_description/config/kinematics/user/xarm6_kinematics_AAA.yaml</h1>
<h1 class="doxsection"><a class="anchor" id="autotoc_md243"></a>
xarm7: xarm_description/config/kinematics/user/xarm7_kinematics_AAA.yaml</h1>
<h1 class="doxsection"><a class="anchor" id="autotoc_md244"></a>
lite6: xarm_description/config/kinematics/user/lite6_kinematics_AAA.yaml</h1>
<h1 class="doxsection"><a class="anchor" id="autotoc_md245"></a>
uf850: xarm_description/config/kinematics/user/uf850_kinematics_AAA.yaml</h1>
<p>```</p><ul>
<li>参数文件的使用: 在启动launch文件时指定该参数<ul>
<li>注意指定该参数之前要保证对应的配置文件存在，如果不存在，需要先通过脚本连接机械臂生成 </li>
</ul>
</li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
